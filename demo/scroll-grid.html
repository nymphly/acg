<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <style>
    #container {
      width: 900px;
      height: 600px;
      margin: 20;
      padding: 0;
      border: 1px solid blue;
    }

    .acg-label {
      color: blueviolet;
      fill: blueviolet;
      -webkit-mask-image: linear-gradient(to right, black 10px, transparent 100%);
      -webkit-mask-size: 50px 50px;
      mask-image: linear-gradient(to right, black 10px, transparent 100%);
      mask-size: 50px 50px;
    }
  </style>
  <script src='../dist/bundle.js'>
  </script>
</head>

<body>
  <span class="acg-label">qwerty</span>
  <div id="container"></div>
</body>

<script>
  const WIDTH = 900;
  const HEIGHT = 600;
  const CELL_HEIGHT = 30;
  const CELL_WIDTH = 30;

  const borderStrokeConfig = {
    tag: 'path',
    name: 'Border',
    attrs: {
      // fill: 'none',
      stroke: '#0f0',
      'stroke-opacity': '100%',
      'stroke-width': 1,
      d: 'M 0 0',
      class: 'acg-label'
    },
  };

  const textsLayerConfig = {
    tag: 'g',
    name: 'Texts-Layer'
  };

  const rootLayerConfig = {
    tag: 'g',
    name: 'Root',
    content: [
      borderStrokeConfig,
      textsLayerConfig
    ],
  };

  const config = {
    tag: 'svg',
    name: 'Svg',
    attrs: {
      xmlns: 'http://www.w3.org/2000/svg',
      border: 0,
      width: '100%',
      height: '100%',
      class: 'anychart-ui-support',
      style: 'display: block',
    },
    content: [
      rootLayerConfig
    ],
  };

  const t0 = Date.now();
  const stage = acg.create(config);
  const container = document.getElementById('container');
  stage.container = container;
  stage.render();
  console.log(`Render time: ${Date.now() - t0}ms`);


  let offX = 0;
  let offY = 0;
  let dragging = false;

  const pather = acg.pather().setShift(0.5);
  const border = stage.find('Border');

  function drawState(x = 0, y = 0) {
    // console.log('Drawing!!!');
    pather.clear();
    let currX = x;
    let currY = y;

    const textsLayer = stage.find('Texts-Layer');
    const textFactory = textsLayer.factory('Texts-Factory', {
      tag: 'text',
      attrs: {
        'class': 'acg-label'
      }
    });
    textFactory.clear();

    const content = 'AzSxDcFvGbHnJmK,QaWsEd';
    const text = textFactory.add();
    text.attrs = {
      ...text.attrs,
      x: currX,
      y: 10
    };
    text.content = [
      {
        tag: 'tspan',
        name: `${text.name}-Tspan`,
        attrs: {
          'class': 'acg-label'
        },
        content
      }
    ];

    // const content = 'Az';
    while (currX <= WIDTH) {
      pather.moveTo(currX, 0).v(HEIGHT);



      currX += CELL_WIDTH;
    }

    while (currY <= HEIGHT) {
      pather.moveTo(0, currY).h(WIDTH);
      currY += CELL_HEIGHT;
    }
    pather.applyTo(border);
    stage.render();
  }

  drawState();


  container.addEventListener('mousewheel', (e) => {
    e.preventDefault();

    const dX = e.deltaX % CELL_WIDTH;
    const dY = e.deltaY % CELL_HEIGHT;
    offX -= dX;
    offY -= dY;

    drawState(offX % CELL_WIDTH, offY % CELL_HEIGHT);
  });

</script>

</html>